# 📚 수업 코드 시스템 가이드

## 🎯 수업 코드란?

수업 코드는 **강사가 수업을 생성할 때 자동으로 만들어지는 4자리 고유 코드**입니다.

```
예시: AB12, XY34, QW56
```

**시니어 친화적 설계:**
- ✅ 짧은 코드 (4자리)
- ✅ 큰 글씨 (24px)
- ✅ 넓은 자간 (8px)
- ✅ 읽기 쉬운 문자만 사용

---

## 🔑 수업 코드 생성 방식

### 1. 자동 생성 (랜덤)
- **길이:** 4자리 (시니어 친화적 ✨)
- **형식:** 영문 대문자 + 숫자
- **특징:** 혼동 가능한 문자 제외
  - ❌ 제외: `0` (숫자 0), `O` (알파벳 O), `I` (알파벳 I), `1` (숫자 1)
  - ✅ 사용: `ABCDEFGHJKLMNPQRSTUVWXYZ23456789`

### 2. 생성 알고리즘
```javascript
function generateClassCode() {
  const chars = 'ABCDEFGHJKLMNPQRSTUVWXYZ23456789'; // 혼동 가능한 문자 제외
  let code = '';
  for (let i = 0; i < 4; i++) { // 4자리로 변경 (시니어 친화)
    code += chars[Math.floor(Math.random() * chars.length)];
  }
  return code;
}
```

### 3. 고유성 보장
- Firestore 문서 ID로 사용
- 중복 시 자동으로 덮어쓰기 (확률 낮음)
- 예상 조합 수: 약 **104만 개** (32^4)
- **충분한 이유:**
  - 평균 학교: 수십 개 수업
  - 전국 학교: 수만 개 수업
  - 104만 개면 충분히 안전
  - 만료 시스템 (6개월) → 코드 재사용

---

## 👨‍🏫 수업 생성 프로세스

### 강사가 수업을 만드는 방법

#### 1. 수업 생성 API 호출
```bash
POST https://asia-northeast1-story-make-fbbd7.cloudfunctions.net/classCreate

Body:
{
  "className": "2024 봄학기 국어",
  "instructorName": "김선생님",
  "instructorPin": "123456"
}
```

#### 2. 자동 생성 결과
```json
{
  "success": true,
  "classCode": "AB12",  ← 자동 생성! (4자리)
  "className": "2024 봄학기 국어",
  "expiresAt": "2026-07-08T12:00:00.000Z"
}
```

#### 3. 강사가 학생들에게 전달
- 수업 코드: `AB12` (짧고 간단!)
- 학생들은 이 코드로 로그인

---

## 👨‍🎓 학생 로그인 프로세스

### 학생이 수업에 참여하는 방법

#### 1. 로그인 화면에서 입력
```
🎓 수업 코드 입력

┌────────────────┐
│   A  B  1  2   │ ← 강사가 알려준 수업 코드 (4자리, 큰 글씨)
└────────────────┘

┌────────────────┐
│   0  1         │ ← 학생 번호 (2자리 권장)
└────────────────┘
```

#### 2. 자동 등록
- 처음 입장: 자동으로 학생 계정 생성
- 다시 입장: 기존 학생으로 로그인
- 학생 ID 형식: `{classCode}-{learnerCode}`
  - 예: `AB12-01`, `AB12-02`, `XY34-01`

---

## 🔐 보안 및 관리

### 1. 강사 PIN (6자리)
- 수업 생성 시 설정
- 강사만 알고 있어야 함
- 수업 관리/삭제 시 필요
- 예: `123456`, `789012`

### 2. 수업 만료일
- 생성일로부터 **6개월 후** 자동 만료
- 만료 후 로그인 불가
- 작품은 6개월간 저장

### 3. 수업 코드 공유 방법
**권장:**
- ✅ 칠판에 직접 쓰기
- ✅ 종이 유인물 배포
- ✅ 학급 게시판 공지
- ✅ QR 코드로 공유 (향후 기능)

**주의:**
- ⚠️ SNS 공개 게시 금지
- ⚠️ 외부인에게 노출 금지

---

## 📋 수업 코드 예시

### 좋은 예시 ✅
```
AB12  ← 짧고 읽기 쉬움
XY34  ← 혼동 없음
QW56  ← 명확함
```

### 나쁜 예시 (생성 안 됨) ❌
```
O0O0  ← 0과 O 혼동
I1I1  ← I와 1 혼동
0000  ← 전부 0 (실제로는 생성 안 됨)
```

---

## 🛠️ 수업 코드 테스트 방법

### 방법 1: 자동 테스트 스크립트
```bash
cd /home/user/webapp
./test-classroom-login.sh
```

**출력:**
```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🎓 수업 코드 로그인 테스트
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

📝 1단계: 테스트 수업 생성 중...
✅ 수업 생성 완료!
   수업 코드: ABCD1234  ← 자동 생성된 코드

👤 2단계: 학생 로그인 테스트...
✅ 학생 로그인 성공!
   학생 ID: ABCD1234-0001

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
🎯 앱에서 사용하세요:
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

🔑 수업 코드: ABCD1234
👤 학생 번호: 0001
```

### 방법 2: 수동 API 호출
```bash
curl -X POST https://asia-northeast1-story-make-fbbd7.cloudfunctions.net/classCreate \
  -H "Content-Type: application/json" \
  -d '{
    "className": "테스트 수업",
    "instructorName": "홍길동",
    "instructorPin": "123456"
  }'
```

---

## 🎯 실제 사용 시나리오

### 시나리오 1: 학기 초 수업 시작

**강사 (김선생님):**
1. Firebase Functions에서 수업 생성
   - 수업명: "2024년 1학기 국어"
   - 강사명: "김선생님"
   - PIN: "123456"
2. 생성된 수업 코드: **ABCD1234** ✅
3. 첫 수업 시간에 칠판에 큰 글씨로 작성
4. 학생들에게 안내:
   - "앱에서 수업 코드 ABCD1234를 입력하세요"
   - "학생 번호는 출석번호를 사용하세요 (예: 0001, 0002...)"

**학생 (1번 홍길동):**
1. 앱 접속
2. "🎓 수업 코드로 시작하기" 클릭
3. 수업 코드: `ABCD1234` 입력
4. 학생 번호: `0001` 입력
5. ✓ 입장하기 클릭
6. 홈 화면 → 작품 활동 시작! 🎉

### 시나리오 2: 학생 번호 관리

**출석번호 사용 (권장):**
```
1번 홍길동 → 0001
2번 김철수 → 0002
3번 이영희 → 0003
...
30번 박민수 → 0030
```

**자율 번호:**
```
좋아하는 번호 사용 (예: 7777, 1234, 9999)
단, 중복 가능 (같은 번호 사용 시 같은 계정)
```

---

## ❓ 자주 묻는 질문 (FAQ)

### Q1: 수업 코드를 직접 정할 수 있나요?
**A:** 아니요, 보안과 고유성을 위해 **자동 생성**됩니다.

### Q2: 수업 코드가 마음에 안 들어요. 다시 만들 수 있나요?
**A:** 네, 수업을 새로 생성하면 새로운 코드가 발급됩니다.

### Q3: 수업 코드를 잃어버렸어요!
**A:** Firebase Console에서 확인하거나, 강사 PIN으로 조회 가능합니다.
- https://console.firebase.google.com/project/story-make-fbbd7/firestore

### Q4: 한 번에 몇 개의 수업을 만들 수 있나요?
**A:** 제한 없습니다. 필요한 만큼 생성 가능합니다.

### Q5: 학생 번호는 누가 정하나요?
**A:** 
- **강사 지정:** 출석번호 사용 (0001, 0002...)
- **학생 자율:** 좋아하는 4자리 번호

### Q6: 같은 수업 코드에 몇 명까지 입장할 수 있나요?
**A:** 제한 없습니다. 학생 번호만 다르면 무제한 입장 가능.

### Q7: 수업 코드 유효기간은?
**A:** 생성일로부터 **6개월**입니다.

---

## 🔄 수업 코드 라이프사이클

```
1. 수업 생성
   └─→ 수업 코드 자동 생성 (ABCD1234)
        │
        ↓
2. 강사가 학생들에게 공유
   └─→ 칠판, 유인물, 게시판
        │
        ↓
3. 학생들 로그인
   └─→ 수업 코드 + 학생 번호 입력
        │
        ↓
4. 6개월간 활동
   └─→ 작품 생성, 저장, 공유
        │
        ↓
5. 만료 (6개월 후)
   └─→ 새 수업 생성 필요
```

---

## 🚀 다음 단계

### 현재 상태 (구현 완료 ✅)
- ✅ 수업 코드 자동 생성
- ✅ 학생 로그인 UI
- ✅ Firebase Functions 구현

### 다음 단계 (배포 필요 ⏳)
1. **Firebase Functions 배포**
   - 로컬 컴퓨터에서 5분 소요
   - `QUICK_FIREBASE_DEPLOY.md` 참고

2. **강사용 수업 생성 UI 제작**
   - 수업 코드 생성 화면
   - 생성된 코드 표시 (복사 기능)
   - QR 코드 생성

3. **수업 관리 대시보드**
   - 수업 목록
   - 학생 목록
   - 작품 통계

---

**작성일:** 2026-01-08  
**프로젝트:** Story Maker  
**GitHub:** https://github.com/sunsudun25-cloud/hidi-story-maker
